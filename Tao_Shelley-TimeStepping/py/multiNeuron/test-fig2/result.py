
# canonical                    = 0.175578230757
# RK2_noadjust_final_error_list=[ 0.905871657083 , 0.982679406941 , 0.0486889595634 , 0.108893854749 , 0.145775348112 , 0.161937648515 , 0.169672260781 , 0.172953565767]
# RK2_adjusted_final_error_list=[ 0.156209665209 , 0.170908792883 , 0.174424795225 , 0.17529183214 , 0.175506118785 , 0.175560285434 , 0.175573767462 , 0.175577118803 ]
# RK4_noadjust_final_error_list=[ 0.90650328551 , 0.982822531786 , 0.0719952515195 , 0.10890314369 , 0.145777722981 , 0.161938246801 , 0.169672410923 , 0.172953603359 ]
# RK4_adjusted_final_error_list=[ 0.175573571928 , 0.175577947787 , 0.175578214181 , 0.175578230475 , 0.175578231561 , 0.175578231612 , 0.175578231688 , 0.175578231674 ]

# 2 neurons coupled???
# canonical                    = 0.175578230757
# RK2_noadjust_final_error_list=[ 0.905871657083 , 0.982679406941 , 0.0486889595634 , 0.108893854749 , 0.145775348112 , 0.161937648515 , 0.169672260781 , 0.172953565767]
# RK2_adjusted_final_error_list=[ 0.156209665209 , 0.170908792883 , 0.174424795225 , 0.17529183214 , 0.175506118785 , 0.175560285434 , 0.175573767462 , 0.175577118803 ]
# RK4_noadjust_final_error_list=[ 0.90650328551 , 0.982822531786 , 0.0719952515195 , 0.10890314369 , 0.145777722981 , 0.161938246801 , 0.169672410923 , 0.172953603359 ]
# RK4_adjusted_final_error_list=[ 0.175573571928 , 0.175577947787 , 0.175578214181 , 0.175578230475 , 0.175578231561 , 0.175578231612 , 0.175578231688 , 0.175578231674 ]

# canonical                    = 0.978574904727
# RK2_noadjust_final_error_list=[ 0.796688701331 , 0.752261655594 , 0.911919257016 , 0.942847981781 , 0.961495108806 , 0.967799572407 , 0.973702444044 , 0.976280539693]
# RK2_adjusted_final_error_list=[ 0.95797515557 , 0.970803725855 , 0.975426418533 , 0.977207478432 , 0.977943554779 , 0.978275544303 , 0.978433149114 , 0.978509350348]
# RK4_noadjust_final_error_list=[ 0.79736079319 , 0.752431273829 , 0.91195774206 , 0.942857212577 , 0.961497368447 , 0.968694353201 , 0.973702583172 , 0.976280574372]
# RK4_adjusted_final_error_list=[ 0.962580993704 , 0.967297646611 , 0.97215883909 , 0.975189966846 , 0.976845161164 , 0.977705440702 , 0.978142284329 , 0.978362635614]

# canonical                    =0.978556405534
# RK2_noadjust_final_error_list=[ 0.754380848915 , 0.773677382765 , 0.90366106162 , 0.942839574639 , 0.959666732751 , 0.96779770972 , 0.972818331496 , 0.976060931033]
# RK2_adjusted_final_error_list=[ 0.951491984826 , 0.964074043196 , 0.971329481041 , 0.974981682625 , 0.976791693496 , 0.977692034109 , 0.978138929719 , 0.978361799241]
# RK4_noadjust_final_error_list=[ 0.797290815423 , 0.773845629392 , 0.903699792145 , 0.942848805564 , 0.959668996435 , 0.967798270214 , 0.972818470751 , 0.97606096572]
# RK4_adjusted_final_error_list=[ 0.962580993704 , 0.967297646611 , 0.97215883909 , 0.975189966846 , 0.976845161164 , 0.977705440702 , 0.978142284329 , 0.978362635614]

# canonical                    =0.978574904727
# RK2_noadjust_final_error_list=[0.796688701331 ,0.752261655594 ,0.911919257016 ,0.942847981781 ,0.961495108806 ,0.967799572407 ,0.973702444044 ,0.976280539693 ]
# RK2_adjusted_final_error_list=[0.95797515557 ,0.970803725855 ,0.975426418533 ,0.977207478432 ,0.977943554779 ,0.978275544303 ,0.978433149114 ,0.978509350348 ]
# RK4_noadjust_final_error_list=[0.79736079319 ,0.752431273829 ,0.91195774206 ,0.942857212577 ,0.961497368447 ,0.968694353201 ,0.973702583172 ,0.976280574372 ]
# RK4_adjusted_final_error_list=[0.970331719481 ,0.974191751349 ,0.976266529292 ,0.977420391886 ,0.977997189872 ,0.97828894641 ,0.978436480756 ,0.97851018509 ]

# canonical                    = 0.175578230757
# RK2_noadjust_final_error_list=[ 0.905871657083 , 0.982679406941 , 0.0486889595634 , 0.108893854749 , 0.145775348112 , 0.161937648515 , 0.169672260781 , 0.172953565767]
# RK2_adjusted_final_error_list=[ 0.156209665209 , 0.170908792883 , 0.174424795225 , 0.17529183214 , 0.175506118785 , 0.175560285434 , 0.175573767462 , 0.175577118803 ]
# RK4_noadjust_final_error_list=[ 0.90650328551 , 0.982822531786 , 0.0719952515195 , 0.10890314369 , 0.145777722981 , 0.161938246801 , 0.169672410923 , 0.172953603359 ]
# RK4_adjusted_final_error_list=[ 0.175573571928 , 0.175577947787 , 0.175578214181 , 0.175578230475 , 0.175578231561 , 0.175578231612 , 0.175578231688 , 0.175578231674 ]

canonical                    = 0.60875477235
RK2_noadjust_final_error_list=[ 0.0959259373898 , 0.777855330175 , 0.129331488674 , 0.421703588932 , 0.516507203813 , 0.559313875081 , 0.582440044365 , 0.597539031475]
RK2_adjusted_final_error_list=[ 0.540899483655 , 0.59283112151 , 0.604863444207 , 0.607790834164 , 0.608514731786 , 0.608694865521 , 0.608739812146 , 0.608751033018 ]
RK4_noadjust_final_error_list=[ 0.250044560082 , 0.813987012379 , 0.169767161226 , 0.421713171449 , 0.516509623835 , 0.559314480749 , 0.58244019559 , 0.597539069238 ]
RK4_adjusted_final_error_list=[ 0.608737079016 , 0.608753699793 , 0.608754706077 , 0.608754767896 , 0.608754771812 , 0.608754771968 , 0.608754772093 , 0.608754771998 ]


for i in range(len(RK2_noadjust_final_error_list)):
    RK2_noadjust_final_error_list[i] = abs(RK2_noadjust_final_error_list[i] - canonical)
    if (RK2_noadjust_final_error_list[i]>0.5): RK2_noadjust_final_error_list[i] = 1 - RK2_noadjust_final_error_list[i]

for i in range(len(RK2_adjusted_final_error_list)):
    RK2_adjusted_final_error_list[i] = abs(RK2_adjusted_final_error_list[i] - canonical)
    if (RK2_adjusted_final_error_list[i]>0.5): RK2_adjusted_final_error_list[i] = 1 - RK2_adjusted_final_error_list[i]

for i in range(len(RK4_noadjust_final_error_list)):
    RK4_noadjust_final_error_list[i] = abs(RK4_noadjust_final_error_list[i] - canonical)
    if (RK4_noadjust_final_error_list[i]>0.5): RK4_noadjust_final_error_list[i] = 1 - RK4_noadjust_final_error_list[i]

for i in range(len(RK4_adjusted_final_error_list)):
    RK4_adjusted_final_error_list[i] = abs(RK4_adjusted_final_error_list[i] - canonical)
    if (RK4_adjusted_final_error_list[i]>0.5): RK4_adjusted_final_error_list[i] = 1 - RK4_adjusted_final_error_list[i]


ts_list=[]
for i in range(8): ts_list.append(0.001 / 2**i)

# time step lengthes: [0.001, 0.0005, 0.00025, 0.000125, 6.25e-05, 3.125e-05, 1.5625e-05] ...

for i in range(8):
    ts_list[i]=log10(ts_list[i])
    RK2_noadjust_final_error_list[i]=log10(RK2_noadjust_final_error_list[i])
    RK2_adjusted_final_error_list[i]=log10(RK2_adjusted_final_error_list[i])
    RK4_noadjust_final_error_list[i]=log10(RK4_noadjust_final_error_list[i])
    RK4_adjusted_final_error_list[i]=log10(RK4_adjusted_final_error_list[i])

figure()
plot(ts_list, RK2_noadjust_final_error_list, '+b', label='RK2 Org')
plot(ts_list, RK2_adjusted_final_error_list, '.b', label='RK2 Adj')
plot(ts_list, RK4_noadjust_final_error_list, 'xr', label='RK4 Org')
plot(ts_list, RK4_adjusted_final_error_list, '*r', label='RK4 Adj')

z2n = polyfit(ts_list, RK2_noadjust_final_error_list, 1); p2n = poly1d(z2n) # print(z1) [ 0.31004412  6.65525   ];;; print(p1) 0.31 x + 6.655
z2a = polyfit(ts_list, RK2_adjusted_final_error_list, 1); p2a = poly1d(z2a)
z4n = polyfit(ts_list, RK4_noadjust_final_error_list, 1); p4n = poly1d(z4n)
z4a = polyfit(ts_list[:5], RK4_adjusted_final_error_list[:5], 1); p4a = poly1d(z4a)

print "\n fit RK2 noAdjust:", p2n
print "\n fit RK2 Adjusted:", p2a
print "\n fit RK4 noAdjust:", p4n
print "\n fit RK4 Adjusted:", p4a

plot(ts_list, p2n(ts_list), 'b', label='%s'%p2n)
plot(ts_list, p2a(ts_list), 'b', label='%s'%p2a)
plot(ts_list, p4n(ts_list), 'r', label='%s'%p4n)
plot(ts_list[:5], p4a(ts_list[:5]), 'r', label='%s'%p4a)

legend(loc='upper left')
xlabel("$\log_{10}$(time_step)")
ylabel("$\log_{10}$(error)")
# title("")
savefig('final_error_list.pdf', dpi=600)

